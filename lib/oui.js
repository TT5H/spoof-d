// OUI (Organizationally Unique Identifier) database
// Common MAC address vendor prefixes
// This is a subset - can be expanded with full IEEE OUI database

const OUI_DB = {
  "00:05:69": "VMware",
  "00:0C:29": "VMware",
  "00:50:56": "VMware",
  "00:16:3E": "Xen",
  "00:03:FF": "Microsoft Hyper-V",
  "00:1C:42": "Parallels",
  "00:0F:4B": "Virtual Iron",
  "08:00:27": "VirtualBox",
  "00:1B:21": "Intel",
  "00:1E:67": "Intel",
  "00:21:70": "Intel",
  "00:25:00": "Intel",
  "00:26:B9": "Intel",
  "00:1A:79": "Intel",
  "00:15:17": "Intel",
  "00:13:CE": "Intel",
  "00:0D:3A": "Intel",
  "00:0E:0C": "Intel",
  "00:11:11": "Intel",
  "00:14:4F": "Intel",
  "00:16:76": "Intel",
  "00:18:DE": "Intel",
  "00:1B:77": "Intel",
  "00:1C:C0": "Intel",
  "00:1D:7E": "Intel",
  "00:1E:67": "Intel",
  "00:21:5C": "Intel",
  "00:23:14": "Intel",
  "00:23:DF": "Intel",
  "00:24:D6": "Intel",
  "00:25:00": "Intel",
  "00:26:18": "Intel",
  "00:26:4A": "Intel",
  "00:26:B9": "Intel",
  "00:26:C7": "Intel",
  "00:27:13": "Intel",
  "00:50:56": "VMware",
  "00:0C:29": "VMware",
  "00:05:69": "VMware",
  "00:1B:21": "Intel",
  "00:1E:67": "Intel",
  "00:21:70": "Intel",
  "00:25:00": "Intel",
  "00:26:B9": "Intel",
  "00:1A:79": "Intel",
  "00:15:17": "Intel",
  "00:13:CE": "Intel",
  "00:0D:3A": "Intel",
  "00:0E:0C": "Intel",
  "00:11:11": "Intel",
  "00:14:4F": "Intel",
  "00:16:76": "Intel",
  "00:18:DE": "Intel",
  "00:1B:77": "Intel",
  "00:1C:C0": "Intel",
  "00:1D:7E": "Intel",
  "00:1E:67": "Intel",
  "00:21:5C": "Intel",
  "00:23:14": "Intel",
  "00:23:DF": "Intel",
  "00:24:D6": "Intel",
  "00:25:00": "Intel",
  "00:26:18": "Intel",
  "00:26:4A": "Intel",
  "00:26:B9": "Intel",
  "00:26:C7": "Intel",
  "00:27:13": "Intel",
  "00:50:F2": "Apple",
  "00:1E:C2": "Apple",
  "00:23:12": "Apple",
  "00:23:6C": "Apple",
  "00:23:DF": "Apple",
  "00:25:00": "Apple",
  "00:25:4B": "Apple",
  "00:26:08": "Apple",
  "00:26:4A": "Apple",
  "00:26:BB": "Apple",
  "00:26:CA": "Apple",
  "00:50:E4": "Apple",
  "00:56:CD": "Apple",
  "00:61:71": "Apple",
  "00:6D:52": "Apple",
  "00:88:65": "Apple",
  "00:A0:40": "Apple",
  "00:C6:10": "Apple",
  "00:CD:FE": "Apple",
  "00:F4:B9": "Apple",
  "00:F7:6F": "Apple",
  "04:0C:CE": "Apple",
  "04:15:52": "Apple",
  "04:1E:64": "Apple",
  "04:26:65": "Apple",
  "04:4B:ED": "Apple",
  "04:54:53": "Apple",
  "04:7D:7B": "Apple",
  "04:8D:38": "Apple",
  "04:9A:4F": "Apple",
  "04:9F:CA": "Apple",
  "04:A3:16": "Apple",
  "04:DB:56": "Apple",
  "04:E5:36": "Apple",
  "04:F1:3E": "Apple",
  "04:F7:E4": "Apple",
  "08:00:27": "VirtualBox",
  "08:66:98": "Apple",
  "08:70:45": "Apple",
  "08:74:02": "Apple",
  "08:9E:01": "Apple",
  "08:CC:68": "Apple",
  "0C:3E:9F": "Apple",
  "0C:4D:E9": "Apple",
  "0C:51:01": "Apple",
  "0C:74:C2": "Apple",
  "0C:BC:9F": "Apple",
  "0C:D2:92": "Apple",
  "0C:E5:D3": "Apple",
  "10:93:E9": "Apple",
  "10:9A:DD": "Apple",
  "10:DD:B1": "Apple",
  "14:10:9F": "Apple",
  "14:7D:DA": "Apple",
  "14:99:E2": "Apple",
  "14:CC:20": "Apple",
  "18:20:32": "Apple",
  "18:65:90": "Apple",
  "18:AF:61": "Apple",
  "1C:1A:C0": "Apple",
  "1C:AB:A7": "Apple",
  "20:78:F0": "Apple",
  "20:AB:37": "Apple",
  "20:C9:D0": "Apple",
  "24:A0:74": "Apple",
  "24:AB:81": "Apple",
  "24:E3:14": "Apple",
  "28:37:37": "Apple",
  "28:6A:B8": "Apple",
  "28:CF:DA": "Apple",
  "28:CF:E9": "Apple",
  "2C:1F:23": "Apple",
  "2C:33:7A": "Apple",
  "2C:BE:08": "Apple",
  "30:90:AB": "Apple",
  "34:15:9E": "Apple",
  "34:A3:95": "Apple",
  "34:C0:59": "Apple",
  "38:CA:DA": "Apple",
  "3C:07:54": "Apple",
  "3C:15:C2": "Apple",
  "3C:D0:F8": "Apple",
  "40:33:1A": "Apple",
  "40:6C:8F": "Apple",
  "40:A6:D9": "Apple",
  "40:CB:C0": "Apple",
  "44:4C:0C": "Apple",
  "44:FB:42": "Apple",
  "48:43:7C": "Apple",
  "48:BF:6B": "Apple",
  "4C:8D:79": "Apple",
  "50:EA:D6": "Apple",
  "54:26:96": "Apple",
  "54:72:4F": "Apple",
  "58:55:CA": "Apple",
  "5C:59:48": "Apple",
  "5C:95:AE": "Apple",
  "60:33:4B": "Apple",
  "60:C5:47": "Apple",
  "64:A3:CB": "Apple",
  "68:96:7B": "Apple",
  "6C:40:08": "Apple",
  "6C:72:20": "Apple",
  "70:48:0F": "Apple",
  "70:56:51": "Realtek",
  "74:E2:F5": "Apple",
  "78:31:C1": "Apple",
  "78:4F:43": "Apple",
  "7C:6D:62": "Apple",
  "80:BE:05": "Apple",
  "84:38:35": "Apple",
  "84:FC:FE": "Apple",
  "88:63:DF": "Apple",
  "8C:85:90": "Apple",
  "90:72:40": "Apple",
  "94:E9:6A": "Apple",
  "98:5F:D3": "Apple",
  "9C:84:BF": "Apple",
  "A0:99:9B": "Apple",
  "A4:5E:60": "Apple",
  "A4:C3:61": "Apple",
  "A8:60:B6": "Apple",
  "AC:1F:74": "Apple",
  "AC:BC:32": "Apple",
  "B0:65:BD": "Apple",
  "B4:F0:AB": "Apple",
  "B8:09:8A": "Apple",
  "B8:53:AC": "Apple",
  "BC:3B:AF": "Apple",
  "BC:52:B7": "Apple",
  "C0:25:E9": "Apple",
  "C4:2C:03": "Apple",
  "C8:1E:E7": "Apple",
  "CC:08:E0": "Apple",
  "D0:03:4B": "Apple",
  "D4:9A:20": "Apple",
  "D8:30:62": "Apple",
  "D8:A2:5E": "Apple",
  "DC:2B:61": "Apple",
  "E0:AC:CB": "Apple",
  "E4:CE:8F": "Apple",
  "E8:40:40": "Apple",
  "EC:35:86": "Apple",
  "F0:18:98": "Apple",
  "F0:DB:E2": "Apple",
  "F4:F1:5A": "Apple",
  "F8:1E:DF": "Apple",
  "FC:25:3F": "Apple",
  "00:1B:21": "Intel",
  "00:1E:67": "Intel",
  "00:21:70": "Intel",
  "00:25:00": "Intel",
  "00:26:B9": "Intel",
  "00:1A:79": "Intel",
  "00:15:17": "Intel",
  "00:13:CE": "Intel",
  "00:0D:3A": "Intel",
  "00:0E:0C": "Intel",
  "00:11:11": "Intel",
  "00:14:4F": "Intel",
  "00:16:76": "Intel",
  "00:18:DE": "Intel",
  "00:1B:77": "Intel",
  "00:1C:C0": "Intel",
  "00:1D:7E": "Intel",
  "00:1E:67": "Intel",
  "00:21:5C": "Intel",
  "00:23:14": "Intel",
  "00:23:DF": "Intel",
  "00:24:D6": "Intel",
  "00:25:00": "Intel",
  "00:26:18": "Intel",
  "00:26:4A": "Intel",
  "00:26:B9": "Intel",
  "00:26:C7": "Intel",
  "00:27:13": "Intel",
  "00:50:56": "VMware",
  "00:0C:29": "VMware",
  "00:05:69": "VMware",
  "00:16:3E": "Xen",
  "00:03:FF": "Microsoft Hyper-V",
  "00:1C:42": "Parallels",
  "00:0F:4B": "Virtual Iron",
  "08:00:27": "VirtualBox",
};

function lookupVendor(mac) {
  if (!mac) return null;
  
  // Normalize MAC address
  const normalized = mac.replace(/[:-]/g, "").toUpperCase();
  if (normalized.length < 6) return null;
  
  // Get first 3 bytes (6 hex characters)
  const prefix = normalized.substring(0, 6);
  const formattedPrefix = `${prefix.substring(0, 2)}:${prefix.substring(2, 4)}:${prefix.substring(4, 6)}`;
  
  return OUI_DB[formattedPrefix] || OUI_DB[prefix] || null;
}

function getVendorInfo(mac) {
  const vendor = lookupVendor(mac);
  return {
    mac: mac,
    vendor: vendor || "Unknown",
    prefix: mac.substring(0, 8),
  };
}

module.exports = {
  lookupVendor,
  getVendorInfo,
  OUI_DB,
};
